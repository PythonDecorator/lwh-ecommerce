{% extends 'base.html' %}
{% load item_tags %}
{% load  static %}
{% block content %}
    <section class="inner-section single-banner"
             style="background: url({% static 'assets/images/single-banner.jpg' %}) no-repeat center;">
        <div class="container"><h2>Gimsap Products</h2>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home:home_page' %}">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Products</li>
            </ol>
        </div>
    </section>
    <section class="inner-section shop-part">
        <div class="container">

            <div class="col-lg-12">
                <form action=".">
                    <div class="top-filter">
                        <div class="filter-show"><label class="filter-label"> :</label>
                            <input type="text" class=""></div>
                        <div class="filter-short">
                            <label class="filter-label">Category :</label>


                            <select
                                    class="form-select filter-select"
                                    onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);">
                                <option value="" selected>---Select---</option>
                                {% for item in Categorys %}
                                    <option value="{{ item.get_absolute_url }}" name="{{ item.name|safe }}"
                                            onclick="window.location({{ item.get_absolute_url }})">{{ item.name|safe }}</option>

                                {% endfor %}
                            </select>

                        </div>

                    </div>
                </form>
            </div>
            <div class="row row-cols-2 row-cols-md-3 row-cols-lg-3 row-cols-xl-5">
                {% for item in item_list %}
                    <div class="col">
                        <div class="product-card shadow">
                            <div class="product-media">
                                <div class="product-label"><label class="label-text new">sale</label></div>
                                <button class="product-wish wish {% wish_list_active request.COOKIES.gimsap_device item.id %} ">
                                    <i class="fas fa-heart"
                                       onclick="add_or_remove_wishlist({{ item.id }},'{% add_or_delete_tag request.COOKIES.gimsap_device item.id %}')"></i>
                                </button>
                                <a class="product-image" href="{{ item.get_absolute_url }}">
                                    <img src="{{ item.imageURL }}"
                                         alt="product" style="width:178px; max-height:178px;object-fit:fill"></a>
                                <div class="product-widget">

                                    <a
                                            title="Product View"
                                            href="#" class="fas fa-eye" data-bs-toggle="modal"
                                            data-bs-target="#items-product-view{{ item.id }}"></a>

                                </div>
                            </div>
                            <div class="product-content">

                                <h6 class="product-name fw-bold"><a
                                        href="{{ item.get_absolute_url }}">{{ item.name|safe|truncatechars:35 }}</a>
                                </h6>
                                <h6 class="product-price">
                                    {% if item.discount %}
                                        <del>${{ item.price }}</del>
                                        <span>${{ item.discount }}<small>/discount</small></span>
                                    {% else %}
                                        <span>${{ item.price }}</span>
                                    {% endif %}</h6>
                                <button class="product-add" title="Add to Cart"><i
                                        class="fas fa-shopping-basket"></i><span>add</span></button>
                                <div class="product-action">
                                    <button class=""
                                            title="Quantity Minus"><i
                                            class="icofont-minus"
                                            onclick="addAndRemoveFromCart({{ item.id }},'remove')"></i>
                                    </button>
                                    <input type="hidden" id="{{ item.id }}_id_item_id" class="{{ item.id }}_id_item_id"
                                           name="item_id"
                                           value="{{ item.id }}">
                                    <input class="action-input {{ item.id }}_id_item_count"
                                           title="Quantity Number"
                                           name="item_count"
                                           id="{{ item.id }}_id_item_count"
                                           type="text"
                                           value="{% item_quantity request.COOKIES.gimsap_device item.id %}">
                                    <button class="" title="Quantity Plus"><i
                                            class="icofont-plus"
                                            onclick="addAndRemoveFromCart({{ item.id }},'add')"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal fade" id="items-product-view{{ item.id }}">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <button class="modal-close icofont-close"
                                        data-bs-dismiss="modal"></button>
                                <div class="product-view">
                                    <div class="row">
                                        <div class="col-md-6 col-lg-6">
                                            <div class="view-gallery"
                                                 style="height: 100%; ">

                                                <ul class="preview-slider slider-arrow" style="height: 100%">
                                                    <li><img src="{{ item.imageURL }}" alt="product"
                                                             style="object-fit: contain;max-height: 317px;min-height: 200px;">
                                                    </li>
                                                </ul>
                                                <ul class="thumb-slider">

                                                </ul>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-6">
                                            <div class="view-details">

                                                <h3
                                                        class="view-name"
                                                        style="white-space: pre-line !important;  ">
                                                    <a href="{{ item.get_absolute_url }}">
                                                        {{ item.name|safe }}</a>
                                                </h3>

                                                <div class="view-rating"><i
                                                        class="active icofont-star"></i><i
                                                        class="active icofont-star"></i><i
                                                        class="active icofont-star"></i><i
                                                        class="active icofont-star"></i><i
                                                        class="active icofont-star"></i>
                                                    ({{ item.review_count }}
                                                    reviews)
                                                </div>
                                                <h3 class="view-price">
                                                    {% if item.discount %}
                                                        <del>${{ item.price }}</del>
                                                        <span>${{ item.discount }}<small>/discount</small></span>
                                                    {% else %}
                                                        <span>${{ item.price }}</span>
                                                    {% endif %}</h3>
                                                <p class="view-desc">{{ item.description|safe }}</p>


                                                <div class="view-add-group">
                                                    <button class="product-add" title="Add to Cart"><i
                                                            class="fas fa-shopping-basket"></i><span>add to cart</span>
                                                    </button>
                                                    <div class="product-action">
                                                        <button class=""
                                                                title="Quantity Minus"><i
                                                                class="icofont-minus"
                                                                onclick="addAndRemoveFromCart({{ item.id }},'remove')"></i>
                                                        </button>
                                                        <input type="hidden"
                                                               id="{{ item.id }}_id_item_id"
                                                               class="{{ item.id }}_id_item_id"
                                                               name="item_id"
                                                               value="{{ item.id }}">
                                                        <input class="action-input {{ item.id }}_id_item_count"
                                                               title="Quantity Number"
                                                               name="item_count"
                                                               id="{{ item.id }}_id_item_count"
                                                               type="text"
                                                               value="{% item_quantity request.COOKIES.gimsap_device item.id %}">
                                                        <button class="" title="Quantity Plus"><i
                                                                class="icofont-plus"
                                                                onclick="addAndRemoveFromCart({{ item.id }},'add')"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="details-action-group">
                                                    <button class="product-add btn-outline-success "
                                                            type="submit"
                                                            title="Add Your Wishlist"
                                                            onclick="add_or_remove_wishlist({{ item.id }},'{% add_or_delete_tag request.COOKIES.gimsap_device item.id %}')">
                                                        <i
                                                                class="icofont-heart"></i><span>{% add_or_delete_tag request.COOKIES.gimsap_device item.id %}  wishlist</span>
                                                    </button>

                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}


            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="bottom-paginate"><p class="page-info">
                        Showing {{ page_obj.number }}
                        of {{ page_obj.paginator.num_pages }} Pages</p>
                        {% if is_paginated %}
                            <ul class="pagination">
                                {% if page_obj.has_previous %}
                                    <li class="page-item"><a class="page-link"
                                                             href="{% paginate_url page_obj.previous_page_number 'page' request.GET.urlencode %}"><i
                                            class="fas fa-long-arrow-alt-left"></i></a></li>
                                {% else %}
                                    <li class="page-item"><a class="page-link" href="#"><i
                                            class="fas fa-long-arrow-alt-left"></i></a></li>
                                {% endif %}
                                {% for i in paginator.page_range %}
                                    {% if page_obj.number == i %}

                                        <li class="page-item"><a class="page-link active">{{ i }}</a></li>
                                    {% else %}
                                        <li class="page-item"><a class="page-link"
                                                                 href="{% paginate_url i 'page' request.GET.urlencode %}">{{ i }}</a>
                                        </li>
                                    {% endif %}
                                {% endfor %}
                                {% if page_obj.has_next %}
                                    <li class="page-item pl-2 ">
                                        <a class="page-link"
                                           href="{% paginate_url page_obj.next_page_number 'page' request.GET.urlencode %}"><i
                                                class="fas fa-long-arrow-alt-right"></i></a>
                                    </li>
                                {% else %}
                                    <li class="page-item"><a class="page-link" href="#"><i
                                            class="fas fa-long-arrow-alt-right"></i></a>
                                    </li>
                                {% endif %}

                            </ul>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}


{% block script %}
<script>
    const itemList = JSON.parse(document.getElementById('item-list-data').textContent);
    console.log(itemList);
</script>


{% endblock %}